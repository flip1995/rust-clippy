use std::fmt::Write;

use crate::utils::{UpdateMode, Version, replace_region_in_file};

const CARGO_TOML_FILES: [&str; 4] = [
    "clippy_config/Cargo.toml",
    "clippy_lints/Cargo.toml",
    "clippy_utils/Cargo.toml",
    "Cargo.toml",
];

pub fn bump_version(mut version: Version) {
    version.minor += 1;
    for &file in &CARGO_TOML_FILES {
        replace_region_in_file(
            UpdateMode::Change,
            file.as_ref(),
            "# begin autogenerated version\n",
            "# end autogenerated version",
            |res| {
                writeln!(res, "version = \"{}\"", version.toml_display()).unwrap();
            },
        );
    }
}
